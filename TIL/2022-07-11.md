넘파이가 빠른 이유: 다차원 배열을 쉽게 처리할 수 있도록 지원(내부가 C언어로 되어있음, 벡터화, 반복문을 사용하지 않음, 모든 연산이 브로드캐스트 방식으로 동작)

스칼라, 벡터(1차원), 행렬(2차원), 텐서(n차원, 이미지 데이터가 대표적인 3차원 데이터)
(이미지사이즈 , 1) --> 흑백이미지 
(이미지사이즈, 3) --> RGB 컬러이미지

Ones와 Ones_like의 차이점?
ones는 shape, ones_like는 array
ones_like(7) --->숫자 만큼 1로 채워줘라

ndarray.ndim: 배열의 축(차원) 수
ndarray.itemsize: 배열의 각 요소의 크기(바이트)

<Data type>
Data type을 줄이면 메모리를 효율적으로 사용할 수 있다. 
Parquet: 열 기반으로 용량을 줄임

<배열생성>
np.arange(): 특정 범위값에 해당하는 배열 생성
np.linspace(): 지정 범위의 균일한 간격의 숫자 반환

<broadcasting>
행과 열의 개수가 달라도 계산이 가능
앞의 열 수와 뒤의 행 수가 일치해야한다

팬시 인덱싱: 슬라이싱과 인덱싱을 동시에

이미지 데이터에 Transpose를 하면 90도 회전이 된다

<얕은 복사와 깊은 복사>
얕은복사: view(): 원본 값 바뀜
깊은복사: copy(): 원본값에 영향 없음


넘파이는 왜 판다스로 파일 IO를 권장할까?
다양한 형태의 포맷을 다룰 때는 판다스가 더 유리하기 때문이다
  
- Numpy
  - np.ones는 shape가 들어가고, np.ones_like는 array의 shape가 들어감
  - 이미지 데이터에 np.transpose를 사용하면, 이미지가 회전함
  - view(얕은 복사)는 원본에 영향을, copy(깊은 복사)는 원본에 영향을 주지 않음
  - a@b = np.dot(a,b) = np.matmul
- CNN (Convolution Neural Network, 합성곱 신경망)
  - 이미지 데이터에서, 주변 정보를 연결해 보고자할 때 사용 (인접 데이터를 조사해 특징을 파악)
  - 픽셀마다 다른 가중치를 부여함
- 특징 추출 영역: 합성곱층(필터 적용, 활성화 함수 반영)과 풀링층(선택적)을 여러 겹 쌓은 형태
  - 필터: 각 레이어의 입출력 데이터의 형상 유지, 복수의 필터로 이미지의 특징 추출 및 학습 (수용영역, 필터, 커널)
- Flatten 레이어: 추출된 주요 특징을 FC에 전달하기 위해 이미지 데이터를 배열 형태(1차원)로 전환
- 클래스 분류 영역: CNN 마지막 부분에는 분류를 위한 FC 추가
--- 
- 필터(Filter): 공용 파라미터로 학습의 대상이며, 합성곱의 가중치에 해당
- 커널(Kernel): sliding window하는 영역에서의 크기
- 스트라이드(Stride): 필터를 적용하는 간격
- 패딩(Padding): 외곽에 지정된 픽셀만큼 특정 값으로 채워 넣음
  - valid: 유효한 영역만 출력
  - same: 출력과 입력의 사이즈 동일
- 채널(Channel): 여러개의 채널을 가진 1개의 커널 (RGB)
- 특징맵(Feature Map): 필터가 순회하며 합성곱을 통해 만든 출력
- 액티베이션 맵(Activation Map): 피쳐 맵에 활성화 함수를 적용한 최종 출력층
- 풀링(Pooling): 출력 데이터의 크기를 줄이거나 특정 데이터를 강종
  - 행렬의 크기는 감소하지만 채널 수 변경은 없음
  - Max, Min, Average
- 데이터 증강(Data Augmentation)
- openCV
  
CNN: 이미지를 특징의 필터와 합성곱을 통하여 이미지의 특징을 추출하고 그를 기반으로 이미지를 판단한다(?)

--
filters: 컨볼루션 필터의 수
kernel size: 컨볼루션 커널의 사이즈
padding: 경계 처리 방법
- valid: 합성곱 후 유효한 영역만 출력
- same: 입력과 동일한 크기를 같도록 상하좌우 0값을 패딩해줌
Stride: 필터가 움직이는 간격의 수
--
  
[과대적합을 막는 방법]

1) 더 많은 훈련 데이터를 모읍니다.
2) 네트워크의 용량을 줄입니다.
   - 128 > 64 이런식으로 줄임 (언더피팅이 되어서 더 낮아질 수도 있음)
3) 가중치 규제를 추가합니다.
   - 레이어를 구성할 때 weight값에 regularization을 하는 것
     (절대값 or 제곱)
4) 드롭아웃을 추가합니다.

numpy
view 얕은복사 원본값 영향
copy 깊은복사 원본 영향 x

### CNN
합성곱 신경망 Convolution Neural Network
다층 퍼셉트론으로 이미지를 펼치면 이미지의 지역적 정보 소실
→ 각 영역의 인접 데이터를 조사해 특징 파악
구조
  데이터를 feature(특징, 차원)로 추출하여 패턴을 파악
핵심 요소
필터
합성곱층
풀링층 max, average
용량 감소, 과적합 방지

영역
특징 추출 영역
합성곱 층, 풀링 층
클래스 분류 영역

np.where(조건, 조건True이면 나오는 값, 조건 False이면 나오는 값)
-------------------------------------------------------
이미지 데이터를 flatten해서 넣어주게 되면 옆에 있는 공간정보가 사라지게 된다는 단점이 있다.
이를 보완할 수 있는게 CNN이다.
가산혼합 : 빛의 삼원색을 이용해, 색을 섞을수록 밝아짐.(RGB: 컴퓨터 및 디스플레이 장치에 사용됨.)
감산혼합은 색을 섞을수록 어두어짐 (인쇄)

CNN(합성곱 신경망) : 
인접 데이터를 조사해 특징을 파악 (다층 퍼셉트론: 이전 셀과 다음 셀과의 상관관계가 높음)
풀링층: 데이터를 압축해줌.
----------------------------------------
CNN = 피쳐 자동 추출기라는 별명을 가지고 있다.
머신러닝은 사람이 피처를 추출, 딥러닝은 모델이 피처를 자동으로 추출

합성곱
input_shape(28,28,1) : 28*28 사이즈의 한 개의 채널1=흑백이미지다.
커널: 슬라이딩 윈도우 하는 영역에서의 크기 짝수는 잘 사용하지않는다.(3,3),(5,5) 보통 정사각형 모양
스트라이드:필터를 적용하는 간격을 의미.
스트라이드를 높일수록 작은값이 나옴. 너무 크게 적용하면 데이터 손실이 될 수 있다.

풀링: (맥스풀링-큰값만 추출, average 풀링;부드럽게 추출)

맥스풀링의 효과:과적합방지(대부분 맥스풀링을 사용)
데이터증강기법:이미지 데이터가 적거나, 회전이 되었을 때 다르게 학습됨.

이미지 데이터가 장미를 예로 들을 때, 색깔도 다 다르고 배경도 다 달라서 학습하기 어려움
전처리 과정 필요.
  
a@b = np.dot(a,b) = np.matmul(a,b)
SparseCategoricalCrossentropy : label encoding되어 있을 때
과대적합을 방지하는 전략
* 더 많은 훈련 데이터를 모읍니다.
* 네트워크의 용량을 줄입니다.
* 가중치 규제를 추가합니다.
* 드롭아웃을 추가합니다.
스트라이드 : 필터를 적용하는 간격을 의미
패딩 : 합성곱층에서 필터와 스트라이드 작용으로 특징맵의 크기는 입력데이터보다 작아짐
액티베이션맵 : 필터를 통해 추출된 피쳐맵에 활성화함수를 적용한 최종 출력층
풀링 : 합성곱층에서 받은 최종 출력 데이터의 크기를 줄이거나 특정 데이터를 강조
  
